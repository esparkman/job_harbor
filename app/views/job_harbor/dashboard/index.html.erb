<div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
  <%= render JobHarbor::StatCardComponent.new(
    label: "Pending",
    value: @stats.pending_count,
    type: :pending,
    link: pending_jobs_path
  ) %>

  <%= render JobHarbor::StatCardComponent.new(
    label: "Scheduled",
    value: @stats.scheduled_count,
    type: :scheduled,
    link: scheduled_jobs_path
  ) %>

  <%= render JobHarbor::StatCardComponent.new(
    label: "In Progress",
    value: @stats.in_progress_count,
    type: :in_progress,
    link: in_progress_jobs_path
  ) %>

  <%= render JobHarbor::StatCardComponent.new(
    label: "Failed",
    value: @stats.failed_count,
    type: :failed,
    link: failed_jobs_path
  ) %>

  <%= render JobHarbor::StatCardComponent.new(
    label: "Blocked",
    value: @stats.blocked_count,
    type: :blocked,
    link: blocked_jobs_path
  ) %>

  <%= render JobHarbor::StatCardComponent.new(
    label: "Finished (24h)",
    value: @stats.finished_count,
    type: :finished,
    link: finished_jobs_path
  ) %>

  <%= render JobHarbor::StatCardComponent.new(
    label: "Active Workers",
    value: @stats.workers_count,
    type: :workers,
    link: workers_path
  ) %>

  <%= render JobHarbor::StatCardComponent.new(
    label: "Queues",
    value: @stats.queues_count,
    type: :queues,
    link: queues_path
  ) %>

  <%= render JobHarbor::StatCardComponent.new(
    label: "Throughput",
    value: "#{@stats.throughput_per_hour}/hr",
    type: :throughput
  ) %>
</div>

<% if @chart_data.present? %>
  <div class="mt-6">
    <%= render JobHarbor::ChartComponent.new(series: @chart_data, current_range: @chart_range) %>
  </div>
<% end %>

<% if @failure_stats.present? && @failure_stats.any? %>
  <div class="mt-6">
    <%= render JobHarbor::FailureRatesComponent.new(stats: @failure_stats) %>
  </div>
<% end %>

<% if @stats.recent_failures.any? %>
  <div class="card mt-6">
    <div class="card-header">
      <h2 class="card-title">Recent Failures</h2>
    </div>
    <div class="card-content">
      <div class="table-wrapper">
        <table class="sqd-table">
          <thead>
            <tr>
              <th>ID</th>
              <th>Job Class</th>
              <th>Error</th>
              <th>Failed At</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            <% @stats.recent_failures.each do |job| %>
              <tr>
                <td><%= link_to job.id, job_path(job), class: "link font-medium" %></td>
                <td><code class="text-sm font-mono"><%= job.class_name %></code></td>
                <td class="text-sm"><%= truncate(job.error_message || "Unknown error", length: 60) %></td>
                <td class="text-sm"><%= job.failed_at&.strftime("%b %d, %H:%M:%S") || "\u2014" %></td>
                <td>
                  <%= button_to "Retry", retry_job_path(job), method: :post, class: "btn btn-secondary btn-xs" %>
                </td>
              </tr>
            <% end %>
          </tbody>
        </table>
      </div>
    </div>
    <div class="card-footer justify-center">
      <%= link_to "View All Failed Jobs \u2192", failed_jobs_path, class: "link text-sm" %>
    </div>
  </div>
<% end %>
